\subsection{Dedalus}

\textbf{Dedalus} is an open-source pseudo-spectral code which can solve nearly arbitrary partial differential equations which the user specifies in plain text \citep[][source code at: dedalus-project.org]{Burns2016}. Spectral methods are ideal for simulations of stellar interiors, which are typically studied in periodic boxes for local simulations or spherical geometry for global simulations. It is based in Python, is straightforward to use, and has a growing user base. The majority of computation time is spent executing optimized C libraries, such as FFTW or BLAS. We have shown excellent strong scaling on moderate 3D MHD simulations (e.g., resolution $512^3$) up to 8,192 processors on the NASA Pleiades cluster.

Currently, Dedalus can only run simulations in Cartesian geometry, but we have developed a prototype version of Dedalus that can run simulations in spherical geometry. It implements a general strategy we have developed for geometries which include coordinate singularities. We have used this approach to solve problems in cylindrical geometry \cite{Vasil_2016}, and spherical geometry \citep[][submitted to JCP]{p}. In Figure \ref{248890} we show a snapshot from a convection simulation using incompressible hydrodynamics. We have also successfully reproduced the MHD benchmark solution in \cite{Marti_2014}, as well as several other problems \citep[][submitted to JCP]{s}. We are working to fully incorporate the spherical geometry code into the main Dedalus codebase. This requires modifying the equation parser to correctly interpret tensorial (rather than simply scalar) quantities. We also will optimize our spherical harmonic and Jacobi polynomial transforms, by modifying and wrapping the SHTNs code \cite{Schaeffer_2013}.
